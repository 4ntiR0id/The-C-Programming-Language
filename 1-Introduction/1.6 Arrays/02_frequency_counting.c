/*
 * ============================================================================
 * Chapter 1: Introduction
 * Section 1.6: Arrays
 * Topic: Frequency counting examples
 * ============================================================================
 * 
 * ما هو عد التكرار (Frequency Counting)؟
 * ----------------------------------------
 * هو تقنية لحساب عدد مرات ظهور كل عنصر في مجموعة بيانات.
 * المصفوفات مثالية لهذا الغرض.
 * 
 * لماذا مهم؟
 * ----------
 * - تطبيق عملي شائع للمصفوفات
 * - أساس الإحصائيات والتحليلات
 * - يُستخدم في تحليل النصوص، البيانات، إلخ
 * 
 * الفكرة الأساسية:
 * -----------------
 * نستخدم index المصفوفة لتمثيل العنصر الذي نعده
 * ونستخدم قيمة العنصر لتخزين عدد مرات الظهور
 * 
 * ============================================================================
 */

main()
{
    /*
     * ============================================================================
     * المثال الكلاسيكي من K&R: عد الأرقام
     * ============================================================================
     * 
     * المهمة:
     * -------
     * نريد عد عدد مرات ظهور كل رقم (0-9) في المدخلات
     * 
     * الحل:
     * -----
     * نستخدم مصفوفة بـ 10 عناصر:
     * - ndigit[0] لعد الصفرات
     * - ndigit[1] لعد الواحدات
     * - ndigit[2] لعد الاثنينات
     * - ...
     * - ndigit[9] لعد التسعات
     */
    
    int c, i;
    int ndigit[10];  /* مصفوفة لعد الأرقام 0-9 */
    
    printf("Example 1: Count digits (K&R classic)\n");
    printf("======================================\n");
    printf("Enter text (Ctrl+D to end):\n");
    
    /*
     * تهيئة المصفوفة:
     * ---------------
     * مهم جداً! يجب وضع كل العدادات على صفر قبل البدء
     */
    for (i = 0; i < 10; i = i + 1) {
        ndigit[i] = 0;
    }
    
    /*
     * قراءة المدخلات وعد الأرقام:
     */
    while ((c = getchar()) != EOF) {
        /*
         * فحص إذا كان الحرف رقماً:
         */
        if (c >= '0' && c <= '9') {
            /*
             * السطر السحري:
             * -------------
             * c - '0' يحول الحرف لرقم:
             * - '0' - '0' = 0
             * - '1' - '0' = 1
             * - '2' - '0' = 2
             * - ...
             * - '9' - '0' = 9
             * 
             * ثم نستخدم هذا الرقم كـ index للمصفوفة
             * ونزيد العداد المقابل
             */
            ++ndigit[c - '0'];
            
            /*
             * لماذا هذه الطريقة ذكية؟
             * - لا نحتاج 10 شروط if منفصلة
             * - سطر واحد يتعامل مع كل الأرقام
             * - يستفيد من أن الأرقام متتالية في ASCII
             */
        }
    }
    
    /*
     * طباعة النتائج:
     */
    printf("\nDigit counts:\n");
    for (i = 0; i < 10; i = i + 1) {
        printf("%d: %d\n", i, ndigit[i]);
    }
    printf("\n");
}


/*
 * ============================================================================
 * مثال: عد أحرف محددة
 * ============================================================================
 */

count_specific_characters()
{
    int c, i;
    int nvowel[5];   /* عد حروف العلة: a, e, i, o, u */
    char vowels[5];
    
    printf("Example 2: Count vowels\n");
    printf("=======================\n");
    printf("Enter text (Ctrl+D to end):\n");
    
    /*
     * تعريف حروف العلة:
     */
    vowels[0] = 'a';
    vowels[1] = 'e';
    vowels[2] = 'i';
    vowels[3] = 'o';
    vowels[4] = 'u';
    
    /*
     * تهيئة العدادات:
     */
    for (i = 0; i < 5; i = i + 1) {
        nvowel[i] = 0;
    }
    
    /*
     * قراءة وعد:
     */
    while ((c = getchar()) != EOF) {
        /*
         * تحويل لحرف صغير للتبسيط:
         */
        if (c >= 'A' && c <= 'Z') {
            c = c + ('a' - 'A');
        }
        
        /*
         * فحص إذا كان من حروف العلة:
         */
        for (i = 0; i < 5; i = i + 1) {
            if (c == vowels[i]) {
                ++nvowel[i];
            }
        }
    }
    
    /*
     * النتائج:
     */
    printf("\nVowel counts:\n");
    for (i = 0; i < 5; i = i + 1) {
        printf("%c: %d\n", vowels[i], nvowel[i]);
    }
    printf("\n");
}


/*
 * ============================================================================
 * مثال: عد أطوال الكلمات
 * ============================================================================
 */

count_word_lengths()
{
    int c, i;
    int len;
    int wlength[15];  /* عد الكلمات حسب الطول (حتى 15 حرف) */
    int inword;
    
    #define MAXLEN 15
    #define YES 1
    #define NO 0
    
    printf("Example 3: Word length histogram\n");
    printf("=================================\n");
    printf("Enter text (Ctrl+D to end):\n");
    
    /*
     * تهيئة:
     */
    for (i = 0; i < MAXLEN; i = i + 1) {
        wlength[i] = 0;
    }
    
    len = 0;
    inword = NO;
    
    /*
     * معالجة المدخلات:
     */
    while ((c = getchar()) != EOF) {
        /*
         * فحص إذا كان مسافة بيضاء:
         */
        if (c == ' ' || c == '\n' || c == '\t') {
            /*
             * إذا كنا في كلمة، الكلمة انتهت:
             */
            if (inword == YES) {
                /*
                 * عد الكلمة حسب طولها:
                 */
                if (len > 0 && len < MAXLEN) {
                    ++wlength[len];
                }
                
                /*
                 * إعادة تعيين:
                 */
                len = 0;
                inword = NO;
            }
        }
        else {
            /*
             * حرف عادي:
             */
            if (inword == NO) {
                inword = YES;
            }
            ++len;
        }
    }
    
    /*
     * الكلمة الأخيرة (إذا لم يكن هناك سطر جديد في النهاية):
     */
    if (inword == YES && len > 0 && len < MAXLEN) {
        ++wlength[len];
    }
    
    /*
     * طباعة رسم بياني:
     */
    printf("\nWord length histogram:\n");
    for (i = 1; i < MAXLEN; i = i + 1) {
        if (wlength[i] > 0) {
            printf("%2d: ", i);
            /*
             * طباعة نجمة لكل كلمة:
             */
            for (c = 0; c < wlength[i]; c = c + 1) {
                putchar('*');
            }
            putchar('\n');
        }
    }
    printf("\n");
}


/*
 * ============================================================================
 * مثال: عد أنواع الأحرف
 * ============================================================================
 */

count_character_types()
{
    int c, i;
    int counts[4];  /* 0: أرقام، 1: حروف، 2: مسافات، 3: أخرى */
    
    printf("Example 4: Character type frequency\n");
    printf("====================================\n");
    printf("Enter text (Ctrl+D to end):\n");
    
    /*
     * تهيئة:
     */
    for (i = 0; i < 4; i = i + 1) {
        counts[i] = 0;
    }
    
    /*
     * العد:
     */
    while ((c = getchar()) != EOF) {
        if (c >= '0' && c <= '9') {
            ++counts[0];  /* رقم */
        }
        else if ((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z')) {
            ++counts[1];  /* حرف */
        }
        else if (c == ' ' || c == '\t' || c == '\n') {
            ++counts[2];  /* مسافة بيضاء */
        }
        else {
            ++counts[3];  /* أخرى */
        }
    }
    
    /*
     * النتائج:
     */
    printf("\nCharacter type counts:\n");
    printf("Digits:     %d\n", counts[0]);
    printf("Letters:    %d\n", counts[1]);
    printf("Whitespace: %d\n", counts[2]);
    printf("Others:     %d\n\n", counts[3]);
}


/*
 * ============================================================================
 * مثال متقدم: عد كل الأحرف ASCII
 * ============================================================================
 */

count_all_characters()
{
    int c, i;
    int nchar[128];  /* عد لكل حرف ASCII (0-127) */
    
    printf("Example 5: Full ASCII frequency\n");
    printf("===============================\n");
    printf("Enter text (Ctrl+D to end):\n");
    
    /*
     * تهيئة كل العدادات:
     */
    for (i = 0; i < 128; i = i + 1) {
        nchar[i] = 0;
    }
    
    /*
     * العد:
     */
    while ((c = getchar()) != EOF) {
        /*
         * نتأكد أن الحرف ضمن النطاق:
         */
        if (c >= 0 && c < 128) {
            ++nchar[c];
        }
    }
    
    /*
     * طباعة الأحرف التي ظهرت:
     */
    printf("\nCharacter frequencies:\n");
    for (i = 0; i < 128; i = i + 1) {
        if (nchar[i] > 0) {
            /*
             * طباعة الحرف (إذا كان قابلاً للطباعة):
             */
            if (i >= 32 && i < 127) {
                printf("'%c': %d\n", i, nchar[i]);
            }
            else if (i == '\n') {
                printf("'\\n': %d\n", nchar[i]);
            }
            else if (i == '\t') {
                printf("'\\t': %d\n", nchar[i]);
            }
            else {
                printf("[%d]: %d\n", i, nchar[i]);
            }
        }
    }
    printf("\n");
}


/*
 * ============================================================================
 * مثال: رسم بياني أفقي لتوزيع الأرقام
 * ============================================================================
 */

horizontal_histogram()
{
    int c, i, j;
    int ndigit[10];
    
    printf("Example 6: Horizontal histogram of digits\n");
    printf("==========================================\n");
    printf("Enter text (Ctrl+D to end):\n");
    
    /*
     * تهيئة:
     */
    for (i = 0; i < 10; i = i + 1) {
        ndigit[i] = 0;
    }
    
    /*
     * العد:
     */
    while ((c = getchar()) != EOF) {
        if (c >= '0' && c <= '9') {
            ++ndigit[c - '0'];
        }
    }
    
    /*
     * رسم الرسم البياني:
     */
    printf("\nDigit histogram:\n");
    for (i = 0; i < 10; i = i + 1) {
        printf("%d: ", i);
        /*
         * طباعة عدد من النجوم يساوي التكرار:
         */
        for (j = 0; j < ndigit[i]; j = j + 1) {
            putchar('*');
        }
        printf(" (%d)\n", ndigit[i]);
    }
    printf("\n");
}


/*
 * ============================================================================
 * Expected Behavior (أمثلة):
 * ============================================================================
 * 
 * Example 1 (Count digits):
 * ------------------------
 * Input: "Hello 123 World 456"
 * Output:
 *   Digit counts:
 *   0: 0
 *   1: 1
 *   2: 1
 *   3: 1
 *   4: 1
 *   5: 1
 *   6: 1
 *   7: 0
 *   8: 0
 *   9: 0
 * 
 * 
 * Example 2 (Count vowels):
 * -------------------------
 * Input: "Hello World"
 * Output:
 *   Vowel counts:
 *   a: 0
 *   e: 1
 *   i: 0
 *   o: 2
 *   u: 0
 * 
 * 
 * Example 3 (Word lengths):
 * -------------------------
 * Input: "The quick brown fox"
 * Output:
 *   Word length histogram:
 *    3: **
 *    5: **
 * 
 * 
 * Example 6 (Horizontal histogram):
 * ---------------------------------
 * Input: "11223334444"
 * Output:
 *   Digit histogram:
 *   0:  (0)
 *   1: ** (2)
 *   2: ** (2)
 *   3: *** (3)
 *   4: **** (4)
 *   5:  (0)
 *   ...
 * 
 * ============================================================================
 * ملاحظات مهمة:
 * ============================================================================
 * 
 * 1. التهيئة ضرورية:
 *    - يجب وضع كل العدادات على صفر قبل البدء
 *    - بدون تهيئة، ستحتوي قيم عشوائية
 * 
 * 2. استخدام ASCII:
 *    - c - '0' لتحويل رقم ASCII لرقم فعلي
 *    - يعمل لأن الأرقام متتالية في ASCII
 * 
 * 3. الفهرسة الذكية:
 *    - نستخدم index المصفوفة لتمثيل ما نعده
 *    - ndigit[3] = عدد الثلاثات
 *    - هذا يجعل الوصول سريع جداً (O(1))
 * 
 * 4. الحدود:
 *    - تأكد دائماً أن الـ index ضمن حدود المصفوفة
 *    - if (len > 0 && len < MAXLEN) قبل الاستخدام
 * 
 * 5. الرسوم البيانية:
 *    - طريقة رائعة لتصور البيانات
 *    - استخدم حلقة متداخلة لطباعة النجوم
 * 
 * 6. الكفاءة:
 *    - عد التكرار باستخدام مصفوفة سريع جداً
 *    - كل عملية عد هي O(1)
 *    - المجموع O(n) حيث n عدد العناصر
 * 
 * ============================================================================
 */
